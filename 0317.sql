--
--SELECT ENAME 		--ename :
--	,SAL * 3		--quarterly :
--	,COMM  			--commision : why?when? :
--FROM EMP;



--SELECT *
--	FROM emp;
--	
--SELECT ename
--	FROM emp e 
--	WHERE a= 'SMITH';
--	
--SELECT ename
--	FROM emp e 
--;
--	


/*
 *
 */

--SELECT 100 + 5, 10 - 3, 30 * 2, 10 / 3
----	FROM EMP e 
--	;
--	

--SELECT 100+ 5
--	, 10 - 3
--	, 30 * 2
--	, 10 / 3 
--	FROM dual
--	;
	

--SELECT dbms_random.value() 
--	* 100 
--	FROM dual --from dual 은 가상의 from공간, 가상
--	;
	
--SELECT 
--	ENAME 
--	FROM EMP 
--	AS employee
--;
--	

SELECT 
	ENAME 
	AS "employee name"
	FROM EMP emplyee
	;


SELECT *
	FROM EMP 
	ORDER BY SAL;
	
SELSECT *
	FROM EMP 
	ORDER BY SAL DESC;
	



SELECT 
	EMPNO AS "EMPLOYEE_NO",
	ENAME AS "EMPLOYEE_NAME",
	JOB,
	MGR AS "MANAGER",
	HIREDATE,
	SAL AS "SALARY",
	COMM AS "COMMISSION",
	DEPTNO AS "DEPARTMENT_NO"
FROM EMP
ORDER BY DEPTNO DESC, ENAME ASC;


SELECT ENAME
	FROM EMP
	WHERE DEPTNO = '20'
	;



SELECT ENAME, JOB, SAL, DEPTNO
	FROM EMP 
	WHERE DEPTNO =20
AND JOB ='CLERK'
;

--부동호
SELECT * 
	FROM EMP 
	WHERE SAL =5000
;

SELECT * 
	FROM EMP 
	WHERE SAL !=5000
;

SELECT * 
	FROM EMP 
	WHERE SAL <>5000
;

SELECT * 
	FROM EMP 
	WHERE SAL ^=5000
;

SELECT * 
	FROM EMP 
	WHERE NOT SAL =5000
;


SELECT *
	FROM EMP 
	WHERE SAL = (SELECT MAX(SAL)
	FROM EMP);
	


--LIKE연산자



SELECT *
	FROM EMP 
	WHERE ENAME LIKE 'M%'
;

SELECT *
	FROM EMP 
	WHERE ENAME LIKE '_L%'
;

SELECT *
	FROM EMP 
	WHERE ENAME LIKE '%A_M%'
;

SELECT *
	FROM EMP 
	WHERE ENAME NOT LIKE 'S%'
;



--NULL

SELECT *
	FROM EMP
	WHERE COMM = NULL
; 
	
SELECT *
	FROM EMP
	WHERE COMM IS NULL
; 


SELECT *
	FROM EMP
	WHERE MGR = NULL
; 
-- 에러가 안뜨는 이유? 
	
SELECT *
	FROM EMP
	WHERE COMM IS NULL
; 
----
SELECT  EMPNO
	, ENAME
	, SAL
	, DEPTNO
	, JOB
FROM EMP
WHERE J0B = 'CLERK'
	
UNION 

SELECT EMPNO
	, ENAME
	, SAL
	, DEPTNO
	, JOP
	FROM EMP 
	WHERE JOB= 'SALESMAN'
;
---

SELECT  EMPNO
	, ENAME
	, SAL
	, DEPTNO
	FROM EMP
	WHERE DEPTNO = 10
	
UNION 

SELECT EMPNO
	, ENAME
	, SAL
	, COMM  
	FROM EMP 
	WHERE DEPTNO =
10
;


SELECT EMPNO
	,ENAME
	,SAL
	,DEPTNO
FROM EMP 

INTERSECT

SELECT EMPNO
	,ENAME
	,SAL
	,DEPTNO
	FROM EMP 
WHERE DEPTNO=10;



SELECT *
FROM v$sqlfn_metadata
;

SELECT func_id
	,argnum
	,datatype
FROM v$sqlfn_arg_metadata
;

SELECT ENAME
	,UPPER(ENAME)
	,LOWER(ENAME)
	,INITCAP(ENAME)
FROM EMP 
;

SELECT ENAME
	,LENGTH(ENAME)
	AS LENGTH
FROM EMP 
;

SELECT  JOB 
	,SUBSTR(JOB, 1 ,2)
	,SUBSTR(JOB,3,2)
	,SUBSTR(JOB,5) 
FROM EMP 
;	`	

SELECT *
FROM EMP 
	WHERE INSTR(ENAME,'S')>0
; 

SELECT INSTR('HELLO, ORACLE!','L')
	AS INSTR_1
	,INSTR('HELLO, ORACLE!','L',5)
	AS INSTR_2
	,INSTR('HELLO, ORACLE!','L',2,2)
	AS INSTR_3
	FROM DUAL
;




SELECT 'Oracle', LPAD('Oracle', 10, '#') AS LPAD_1,
       RPAD('Oracle', 10, '*') AS RPAD_1,
       LPAD('Oracle', 10) AS LPAD_2,
       RPAD('Oracle', 10) AS RPAD_2
FROM DUAL;

SELECT '[' ||TRIM ('_ _Oracle_ _')||']' AS TRIM,
'[' ||TRIM(LEADING FROM'_ _Oracle_ _')||']' AS TRIM_LEADING,
'[' ||TRIM(TRAILING FROM'_ _Oracle_ _')||']' AS TRIM_TRAILING,
'[' ||TRIM(BOTH FROM'_ _Oracle_ _')||']' AS TRIM_BOTH,
FROM DUAL;

SELECT '[' ||TRIM ('_ _Oracle_ _')||']' AS TRIM,
'[' ||TRIM(LEADING FROM'_ _Oracle_ _')||']' AS TRIM_LEADING,
'[' ||TRIM(TRAILING FROM'_ _Oracle_ _')||']' AS TRIM_TRAILING,
'[' ||TRIM(BOTH FROM'_ _Oracle_ _')||']' AS TRIM_BOTH
FROM DUAL;




SELECT ABS(-100),ABS(0)
FROM DUAL
;

SELECT REMAINDER(15,4) AS C1
	, REMAINDER(15,-4) AS C2
FROM dual
;

SELECT SYSDATE AS NOW
	,SYSDATE-1 AS YESTERDAY
	,SYSDATE+1 AS TOMORROW
FROM DUAL;



SELECT  SYSDATE , ADD_MONTHS(SYSDATE,3)
AS ASDATE
FROM DUAL
;

SELECT EMPNO, ENAME, HIREDATE,
	ADD_MONTHS(HIREDATE, 12*20)
	AS WORK10YEAR
FROM EMP;

SELECT EMPNO
	,ENAME
	,HIREDATE
	,SYSDATE 
FROM EMP 
WHERE ADD_MONTHS(HIREDATE, 12*40)> SYSDATE; 


SELECT SYSDATE ,
	NEXT_DAY(SYSDATE,'월요일'),
	LAST_DAY(SYSDATE) 
FROM DUAL;

SELECT ENAME
	,EXTRACT (YEAR FROM HIREDATE) AS y
	,EXTRACT (MONTH FROM HIREDATE) AS M
	,EXTRACT (DAY FROM HIREDATE) AS D
FROM EMP;

SELECT ENAME, HIREDATE, SYSDATE 	
	,MONTHS_BETWEEN(HIREDATE,SYSDATE)/12 
	AS YEAR1
FROM EMP e ;

-- 
SELECT SYSDATE,ROUND(SYSDATE,'CC') AS FORMAT_CC,
	ROUND(SYSDATE,'YYYY') AS FORMAT_YYYY,
	ROUND(SYSDATE,'Q') AS FORMAT_Q,
	ROUND(SYSDATE,'DDD') AS FORMAT_DDD,
	ROUND(SYSDATE,'HH') AS FORMAT_HH
FROM DUAL
;

SELECT TO_CHAR(sysdate,'YYYY/MM/DD HH24:MI:SS')AS curretn_datetime
FROM dual;

SELECT SYSDATE
	,TO_CHAR(SYSDATE, 'MM') AS MM 
	,TO_CHAR(SYSDATE, 'MON') AS MON 
	,TO_CHAR(SYSDATE, 'MONTH') AS MONTH
 	,TO_CHAR(SYSDATE, 'DD') AS DD 
    ,TO_CHAR(SYSDATE, 'DY') AS DY
	,TO_CHAR(SYSDATE, 'DAY') AS DAY
FROM DUAL;


--ERROR
SELECT SYSDATE 	
	,TO_CHAR(SYSDATE,'HH24:MI:SS')AS HH24MISS
	,TO_CHAR(SYSDATE,'HH12:MI:SS AM')AS HH24MISS_AM
	,TO_CHAR(SYSDATE,'HH:MI:SS P.M')AS HH24MI_PM
FROM DUAL;


SELECT EMPNO
	,ENAME
	,SAL
	,COMM
	,SAL+COMM
	,NVL(COMM,0)
	,SAL+NVL(COMM,0)
FROM EMP;


SELECT SUM(COMM)
FROM EMP;

SELECT EMPNO
	,ENAME
	,SAL
	,COMM
	,SAL+COMM
	,NVL2(COMM,'0','X')
	,NVL2(COMM,SAL*12+COMM,SAL*12)AS ANNSAL
FROM EMP;



SELECT EMPNO, ENAME, COMM
	,CASE 
		WHEN COMM IS NULL THEN ''
		WHEN COMM = 0 THEN 'ZERO'
		WHEN COMM > 0 THEN 'AMOUNT : '|| COMM
		END AS Summary
		
FROM EMP;

--JOIN문 
SELECT *
	FROM EMP,DEPT
	WHERE EMP.DEPTNO=DEPT.DEPTNO
	ORDER BY EMPNO;
	

SELECT *
	FROM EMP E JOIN DEPT D
	ON(E.DEPTNO = D.DEPTNO)
ORDER BY EMPNO;

--P191
SELECT EMPNO, ENAME, DEPTNO , DNAME, LOC
	FROM EMP E, DEPT D
	WHERE E.DEPTNO = D.DEPTNO 
;

SELECT e.empno, e.ename, e.deptno, d.dname, d.loc
   FROM emp e, dept d
   WHERE e.deptno = d.deptno;
  
  

SELECT  E.EMPNO, E.ENAME,E.SAL,D.DEPTNO,D.DNAME,D.LOC
	FROM EMP E, DEPT D
	WHERE E.CEPTNO  D.DEPTNO AND SAL<=2000
;

SELECT  E.EMPNO, E.ENAME,E.SAL,D.DEPTNO,D.DNAME,D.LOC
	FROM EMP E, DEPT D
	WHERE E.DEPTNO = D.DEPTNO AND SAL<=2000;